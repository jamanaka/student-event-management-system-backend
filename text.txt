// In your routes
const { protect, restrictToAdmin } = require('../middlewares/auth.middleware');

// Protected route
router.get('/profile', protect, getUserProfile);

// Admin-only route
router.get('/admin/dashboard', protect, restrictToAdmin, getDashboard);




const { restrictToOwnerOrAdmin } = require('../middlewares/admin.middleware');

// Only event owner or admin can update
router.put('/events/:id', 
    protect, 
    restrictToOwnerOrAdmin('Event'), 
    updateEvent
);






const { authValidations } = require('../middlewares/validation.middleware');

router.post('/register', 
    authValidations.register, 
    registerUser
);





Routes:
auth.routes.js: /api/auth/*

event.routes.js: /api/events/*

rsvp.routes.js: /api/rsvp/* or /api/events/:id/rsvp